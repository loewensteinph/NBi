<?xml version="1.0" encoding="utf-8" ?>
<testSuite name="Acceptance Testing: query equalTo Csv" xmlns="http://NBi/TestSuite">
	<settings>
		<default apply-to="everywhere">
		  <connectionString>Data Source=.\SQL2016;Initial Catalog=Sandbox;Integrated Security=True</connectionString>
		</default>
    <default apply-to="setup-cleanup">
      <variable name="myVar">Test</variable>
    </default>
    <default apply-to="system-under-test">
      <variable name="myVar">Test</variable>
    </default>
	</settings>
	<test name="Excel Test">
    <setup>
      <folder-delete path="C:\temp\test1"/>
      <exe-run path="%windir%\system32" name="cmd.exe" arguments="/c echo test" silent="true" timeout-milliseconds="1000"/>
      <exe-run path="C:\Windows\system32" name="cmd.exe" arguments="/c echo test" silent="false" timeout-milliseconds="1000"/>
      <sql-run>
        UPDATE dbo.$TableName$ SET Test = '1980-01-01'
        WHERE identitytest = $OperatorVar$
        <variable name="OperatorVar">
          4
        </variable>
        <variable name ="TableName">
          Sandbox
        </variable>
      </sql-run>
      <table-reset name="dbo.Sandbox"/>
      <table-load file="..\Excel\Sample.xlsx" name="dbo.Sandbox"/>
    </setup>
		<system-under-test>
			<execution>
        <query>
          UPDATE dbo.Sandbox SET Test = '1980-01-01'         
          SELECT identitytest,
          Test,
          object_id,
          schema_id,
          guid FROM dbo.Sandbox
        </query>
			</execution>
		</system-under-test>
		<assert>
			<equalTo>
        <resultSet file="..\Excel\Sample.xlsx" sheet="dbo#Sandbox">
        </resultSet>
			</equalTo>
		</assert>
	</test>
</testSuite>
